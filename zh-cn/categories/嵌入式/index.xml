<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>åµŒå…¥å¼ on Nansen Li&#39;s Blog
ææ¥ æ£®çš„åšå®¢
</title>
        <link>https://nansenli.com/zh-cn/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/</link>
        <description>Recent content in åµŒå…¥å¼ on Nansen Li&#39;s Blog
ææ¥ æ£®çš„åšå®¢
</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Nansen Li ğŸŒˆ ï¼ˆææ¥ æ£®ï¼‰</copyright>
        <lastBuildDate>Tue, 30 Jan 2018 10:53:00 +0000</lastBuildDate><atom:link href="https://nansenli.com/zh-cn/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>libcurläº¤å‰ç¼–è¯‘armç‰ˆæœ¬åŠ¨æ€åº“</title>
        <link>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/libcurl%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91arm%E7%89%88%E6%9C%AC%E5%8A%A8%E6%80%81%E5%BA%93/</link>
        <pubDate>Tue, 30 Jan 2018 10:53:00 +0000</pubDate>
        
        <guid>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/libcurl%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91arm%E7%89%88%E6%9C%AC%E5%8A%A8%E6%80%81%E5%BA%93/</guid>
        <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€
&lt;/h2&gt;&lt;p&gt;æœ€è¿‘ç”±äºé¡¹ç›®éœ€è¦è¦è¿›è¡Œäº¤å‰ç¼–è¯‘libcurlä»¥å®Œæˆhttpsé€šä¿¡ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„æºç æ–‡ä»¶ï¼Œå¹¶è§£å‹ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://upload-images.jianshu.io/upload_images/4388248-9d2b268681a5a2d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image.png&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ç”¨çš„deepinè‡ªå¸¦äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼Œ&lt;code&gt;sudo apt install gcc-5-arm-linux-gnueabihf&lt;/code&gt;å®‰è£…å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;arm-linuxå†…å®¹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://upload-images.jianshu.io/upload_images/4388248-d030038d08446de5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image.png&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨opensslç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;source ../arm-linux
./Configure --prefix=$(pwd)/../output shared no-asm linux-armv4
make -j4
make install
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¦–å…ˆå¯¼å…¥ç¯å¢ƒå˜é‡ã€‚ç„¶åè¿›è¡Œç¼–è¯‘ï¼Œè¾“å‡ºè·¯å¾„åœ¨outputä¸‹é¢ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶ååœ¨libcurl ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;source ../arm-linux
./configure --with-ssl=$(pwd)/../output --prefix=$PWD/../output --build=x86_64-pc-linux-gnu --host=arm-linux-gnueabihf  CC=arm-linux-gnueabihf-gcc-5 --without-zlib
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;curlé…ç½®ç»“æœä¸€è§ˆ&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  curl version:     7.58.0
  Host setup:       x86_64-pc-linux-gnu
  Install prefix:   /media/linan/72605383-b1ba-4c79-90fd-443514396fbc/curl_workdir/curl-7.58.0/output
  Compiler:         arm-linux-gnueabihf-gcc-5
  SSL support:      enabled (OpenSSL)
  SSH support:      no      (--with-libssh2)
  zlib support:     no      (--with-zlib)
  brotli support:   no      (--with-brotli)
  GSS-API support:  no      (--with-gssapi)
  TLS-SRP support:  enabled
  resolver:         POSIX threaded
  IPv6 support:     enabled
  Unix sockets support: enabled
  IDN support:      no      (--with-{libidn2,winidn})
  Build libcurl:    Shared=yes, Static=yes
  Built-in manual:  enabled
  --libcurl option: enabled (--disable-libcurl-option)
  Verbose errors:   enabled (--disable-verbose)
  SSPI support:     no      (--enable-sspi)
  ca cert bundle:   no
  ca cert path:     no
  ca fallback:      no
  LDAP support:     no      (--enable-ldap / --with-ldap-lib / --with-lber-lib)
  LDAPS support:    no      (--enable-ldaps)
  RTSP support:     enabled
  RTMP support:     no      (--with-librtmp)
  metalink support: no      (--with-libmetalink)
  PSL support:      no      (libpsl not found)
  HTTP2 support:    disabled (--with-nghttp2)
  Protocols:        DICT FILE FTP FTPS GOPHER HTTP HTTPS IMAP IMAPS POP3 POP3S RTSP SMB SMBS SMTP SMTPS TELNET TFTP
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶ååœ¨è¿è¡Œmake ä»¥åŠmake installï¼Œåœ¨curlç›®å½•ä¸‹å°±ä¼šå‡ºç°outputç›®å½•ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯opensslä»¥åŠcurlçš„åŠ¨æ€åº“ï¼Œåˆ†åˆ«æ˜¯ï¼šlibssl.so libcrypto.so libcurl.so&lt;/p&gt;
</description>
        </item>
        <item>
        <title>åœ¨RT-Threadä¸­ä½¿ç”¨stm32çš„halåº“é©±åŠ¨ä¸²å£UART</title>
        <link>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/%E5%9C%A8rt-thread%E4%B8%AD%E4%BD%BF%E7%94%A8stm32%E7%9A%84hal%E5%BA%93%E9%A9%B1%E5%8A%A8%E4%B8%B2%E5%8F%A3uart/</link>
        <pubDate>Thu, 06 Apr 2017 10:22:00 +0000</pubDate>
        
        <guid>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/%E5%9C%A8rt-thread%E4%B8%AD%E4%BD%BF%E7%94%A8stm32%E7%9A%84hal%E5%BA%93%E9%A9%B1%E5%8A%A8%E4%B8%B2%E5%8F%A3uart/</guid>
        <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€
&lt;/h2&gt;&lt;p&gt;ä¹‹å‰ä¸€ç›´åœ¨Linuxä¸‹é¢å°è¯•è¿›è¡Œéƒ¨ç½²äº†RT-Threadçš„stm32çš„å¼€å‘ï¼Œè¿™ç§æ–¹å¼ç¡®å®æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ç§ç§ä¸ä¾¿ä¹‹å¤„ã€‚ä½¿ç”¨VSCode + Scons + openocd è¿›è¡Œç¼–è¾‘ã€ç¼–è¯‘é“¾æ¥ã€çƒ§å½•ç¡®å®æ˜¯å¯ä»¥è¿›è¡Œå¼€å‘ï¼Œä½†æ˜¯è‹¥è¦è¿›è¡Œè°ƒè¯•åˆ™æ²¡æœ‰è¿™ç§ç¯å¢ƒçš„è§£å†³æ–¹æ¡ˆï¼Œåªå¾—åœ¨eclipseä¸­è¿›è¡Œè°ƒè¯•ã€‚è€Œå°†RT-Threadæ”¹æˆeclipseçš„æ–¹æ¡ˆè™½ç„¶å¯è¡Œï¼Œä½†æ˜¯è¿™æ ·è¿˜ä¸å¦‚ç›´æ¥åœ¨windowsä¸‹é¢é‡‡ç”¨keil 5 æ¥è¿›è¡Œå¼€å‘ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºstm32f103æ¿è½½flashè¿‡å°ï¼Œæ ˆä¹Ÿååˆ†çš„å°ï¼Œäºæ˜¯æ¢æˆstm32f411ã€‚æ¿å­æ¥è‡ªäºå¾®é›ªç§‘æŠ€çš„XNUCLEOï¼Œå’ŒSTMå®˜æ–¹NUCLEOæ¿å­æ˜¯å…¼å®¹çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…keil-523&#34;&gt;å®‰è£…Keil 5.23
&lt;/h2&gt;&lt;p&gt;ç”±äºæˆ‘é¦–å…ˆå®‰è£…äº†Keil 5.11ï¼Œç„¶åé™„å¸¦çš„ç ´è§£å™¨ç ´è§£äº†ï¼Œä¹‹åå¸è½½å†å®‰è£…äº†Keil 5.23ï¼Œç›´æ¥æ˜¾ç¤ºå·²ç»ç ´è§£æˆåŠŸã€‚ç ´è§£å™¨ä»ç„¶æ˜¯å¤šå¹´å‰å°±æµè¡Œçš„æ³¨å†Œç ç”Ÿæˆå™¨ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨Keil 5.23ç‰ˆæœ¬ï¼Œæ˜¯å› ä¸ºRT-Threadå·¥ç¨‹åªèƒ½ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬è¿›è¡Œæ‰“å¼€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨pack-installerå®‰è£…åº“&#34;&gt;ä½¿ç”¨pack installerå®‰è£…åº“
&lt;/h2&gt;&lt;p&gt;åªæœ‰å®‰è£…äº†Keil::STM32F4xx_DFPæ‰èƒ½æ‰“å¼€RT-Threadçš„bpsåˆ†æ”¯ä¸‹çš„nucleoå·¥ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…stm32cubemx&#34;&gt;å®‰è£…STM32CubeMX
&lt;/h2&gt;&lt;p&gt;é€šè¿‡STM32CubeMXï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„é€šè¿‡é¼ æ ‡ç‚¹å‡»ç”Ÿæˆåˆå§‹åŒ–ä»£ç ã€‚ä½†æ˜¯è°ƒç”¨å‡½æ•°è¿˜æ˜¯å¾—æˆ‘ä»¬è‡ªå·±å†™ï¼Œä¸å¦‚NPXçš„PEæ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…st-linké©±åŠ¨&#34;&gt;å®‰è£…ST-Linké©±åŠ¨
&lt;/h2&gt;&lt;p&gt;å¾®é›ªç§‘æŠ€å”®å–100å—é’±çš„æ¿å­è¿˜é™„å¸¦äº†ST-Linkè°ƒè¯•å™¨ï¼Œé‚£æˆ‘ä»¬å°±æ˜¯ç”¨ST-Linkæ¥è¿›è¡Œè°ƒè¯•å§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹è½½nucleoå·¥ç¨‹&#34;&gt;ä¸‹è½½nucleoå·¥ç¨‹
&lt;/h2&gt;&lt;p&gt;æ‰“å¼€&lt;code&gt;rt-thread-master\bsp\stm32f411-nucleo&lt;/code&gt;ä¸‹çš„Keil 5å·¥ç¨‹ï¼Œå°è¯•ç¼–è¯‘ï¼Œé€šè¿‡åï¼Œç®€å•è®¾ç½®å·¥ç¨‹çš„debugï¼Œä½¿ç”¨ST-Linkæ¥è¿›è¡Œè°ƒè¯•ï¼Œç„¶åå°†ç¨‹åºä¸‹è½½åˆ°æ¿å­é‡Œé¢ã€‚è™½ç„¶ç¨‹åºä¸‹è¿›å»äº†ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œå› ä¸ºä¸»å‡½æ•°æ˜¯ç©ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;/* user app entry */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#a6e22e&#34;&gt;MX_GPIO_Init&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;){
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#a6e22e&#34;&gt;rt_thread_delay&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#a6e22e&#34;&gt;HAL_GPIO_WritePin&lt;/span&gt; (GPIOC, GPIO_PIN_5, GPIO_PIN_SET);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#a6e22e&#34;&gt;rt_thread_delay&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#a6e22e&#34;&gt;HAL_GPIO_WritePin&lt;/span&gt; (GPIOC, GPIO_PIN_5, GPIO_PIN_RESET);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¹¶åŠ ä¸ŠLEDçš„åˆå§‹åŒ–å‡½æ•°&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;static void MX_GPIO_Init(void)
{

  GPIO_InitTypeDef GPIO_InitStruct;

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOC_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOC, GPIO_PIN_5, GPIO_PIN_RESET);

  /*Configure GPIO pin : PC5 */
  GPIO_InitStruct.Pin = GPIO_PIN_5;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOC, &amp;amp;GPIO_InitStruct);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æ¿è½½çš„LED4ç¯äº®èµ·æ¥äº†ï¼Œå¹¶ä¸”åœ¨é—ªçƒã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›åˆå§‹åŒ–ä»£ç æ˜¯ä»å“ªæ¥çš„å‘¢ï¼Ÿä¸»å‡½æ•°ä¸­çš„ä»£ç ï¼Œæ˜¯ä»ç½‘ä¸Šæ‰¾çš„ï¼Œå¾ˆç®€å•çš„æ“ä½œGPIOçš„å‡½æ•°ï¼Œè€ŒMX_GPIO_Initè¿™æ®µä»£ç ï¼Œåˆ™æ¥è‡ªäºSTM32CubeMXè‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ã€‚ä¸‹é¢ä¼šè®²å¦‚ä½•é€šè¿‡STM32CubeMXç”Ÿæˆåˆå§‹åŒ–UARTä»£ç ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨stm32cubemxç”Ÿæˆuartåˆå§‹åŒ–ä»£ç &#34;&gt;ä½¿ç”¨STM32CubeMXç”ŸæˆUARTåˆå§‹åŒ–ä»£ç 
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;é¦–å…ˆæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå·¥ç¨‹ï¼Œå¹¶è®¾ç½®å¥½èŠ¯ç‰‡å‹å·ï¼Œä¸‹é¢æ˜¯æ¼”ç¤º&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://upload-images.jianshu.io/upload_images/4388248-1dc88ac9df6bb8d3.gif?imageMogr2/auto-orient/strip&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;2017-04-06_16-41-06.gif&#34;
	
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç„¶åè®¾ç½®ä¸²å£å¼•è„šã€‚
ç”±äºRT-Threadå·²ç»åˆå§‹åŒ–äº†ä¸²å£1ï¼Œæˆ‘ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨è¿™ä¸ªã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨UART6ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://upload-images.jianshu.io/upload_images/4388248-67396c8db749e4c2.gif?imageMogr2/auto-orient/strip&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;2017-04-06_16-57-29.gif&#34;
	
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰“å¼€å·¥ç¨‹ï¼Œå°†ä»£ç å·èµ°ï¼Œè“è‰²éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬è¦æ‹¿èµ°çš„ä»£ç &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://upload-images.jianshu.io/upload_images/4388248-5d28c90d61499a22.gif?imageMogr2/auto-orient/strip&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;2017-04-06_17-01-11.gif&#34;
	
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç§»æ¤ä»£ç 
åœ¨void HAL_UART_MspInit(UART_HandleTypeDef *huart)ä¸­ï¼Œæ·»åŠ USART6çš„ä»£ç ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;void HAL_UART_MspInit(UART_HandleTypeDef *huart)
{
    GPIO_InitTypeDef  GPIO_InitStruct;
    if (huart-&amp;gt;Instance == USART2)
    {
        /*##-1- Enable peripherals and GPIO Clocks #################################*/
        /* Enable GPIO TX/RX clock */
        USARTx_TX_GPIO_CLK_ENABLE();
        USARTx_RX_GPIO_CLK_ENABLE();

        /* Enable USARTx clock */
        USARTx_CLK_ENABLE(); 

        /*##-2- Configure peripheral GPIO ##########################################*/  
        /* UART TX GPIO pin configuration  */
        GPIO_InitStruct.Pin       = USARTx_TX_PIN;
        GPIO_InitStruct.Mode      = GPIO_MODE_AF_PP;
        GPIO_InitStruct.Pull      = GPIO_PULLUP;
        GPIO_InitStruct.Speed     = GPIO_SPEED_FAST;
        GPIO_InitStruct.Alternate = USARTx_TX_AF;

        HAL_GPIO_Init(USARTx_TX_GPIO_PORT, &amp;amp;GPIO_InitStruct);
        
        /* UART RX GPIO pin configuration  */
        GPIO_InitStruct.Pin = USARTx_RX_PIN;
        GPIO_InitStruct.Alternate = USARTx_RX_AF;
        
        HAL_GPIO_Init(USARTx_RX_GPIO_PORT, &amp;amp;GPIO_InitStruct);
        
        HAL_NVIC_SetPriority(USART2_IRQn, 0, 1);
        HAL_NVIC_EnableIRQ(USART2_IRQn);
    }
		if (huart-&amp;gt;Instance == USART6)
		{
		/* USER CODE BEGIN USART6_MspInit 0 */

		/* USER CODE END USART6_MspInit 0 */
			/* Peripheral clock enable */
			__HAL_RCC_USART6_CLK_ENABLE();
		
			/**USART6 GPIO Configuration    
			PC6     ------&amp;gt; USART6_TX
			PC7     ------&amp;gt; USART6_RX 
			*/
			GPIO_InitStruct.Pin = GPIO_PIN_6|GPIO_PIN_7;
			GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
			GPIO_InitStruct.Pull = GPIO_PULLUP;
			GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
			GPIO_InitStruct.Alternate = GPIO_AF8_USART6;
			HAL_GPIO_Init(GPIOC, &amp;amp;GPIO_InitStruct);

			/* Peripheral interrupt init */
			HAL_NVIC_SetPriority(USART6_IRQn, 0, 0);
			HAL_NVIC_EnableIRQ(USART6_IRQn);
		/* USER CODE BEGIN USART6_MspInit 1 */

		/* USER CODE END USART6_MspInit 1 */
		}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨main.cæ–‡ä»¶ä¸­ï¼Œæ·»åŠ &lt;code&gt;MX_USART6_UART_Init();&lt;/code&gt;å‡½æ•°å†…å®¹ï¼Œå¹¶åœ¨ä¸»å‡½æ•°ä¸­ï¼Œè°ƒç”¨&lt;code&gt;MX_USART6_UART_Init();&lt;/code&gt;è¿›è¡Œåˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åï¼Œåœ¨main()å‡½æ•°ä¸­è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;		uint8_t TxData[10]= &amp;#34;01234abcde&amp;#34;;
		HAL_UART_Transmit(&amp;amp;huart6,TxData,10,0xf);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å°†å¾®é›ªçš„æ¿å­ä¸Šçš„JP4è·³å¸½æ¥åœ¨å³ä¾§ï¼Œè¿™æ ·ï¼ŒUSB TO UARTå°±èƒ½ä½¿ç”¨PC6ã€PC7ä½œä¸ºä¸²å£æ¥å£äº†ã€‚ç„¶åï¼Œæ¥ä¸ŠUSBæ¥å£åˆ°PCæœºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨XSHELLä¹‹ç±»çš„ä¸²å£ç»ˆç«¯æŸ¥çœ‹PCæ¥å—åˆ°çš„å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>åœ¨RT-Threadä¸­ä½¿ç”¨SPIå’ŒUARTè®¾å¤‡</title>
        <link>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/%E5%9C%A8rt-thread%E4%B8%AD%E4%BD%BF%E7%94%A8spi%E5%92%8Cuart%E8%AE%BE%E5%A4%87/</link>
        <pubDate>Tue, 07 Mar 2017 09:41:00 +0000</pubDate>
        
        <guid>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/%E5%9C%A8rt-thread%E4%B8%AD%E4%BD%BF%E7%94%A8spi%E5%92%8Cuart%E8%AE%BE%E5%A4%87/</guid>
        <description>&lt;p&gt;RT-Threadé‡‡ç”¨äº†ç±»ä¼¼äºlinuxçš„å‡½æ•°è°ƒç”¨æ–¹æ³•ï¼Œè¿™é‡Œè¯´æ˜ä¸€ä¸‹å¦‚ä½•ç®€å•çš„ä½¿ç”¨è®¾å¤‡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¡¬ä»¶ç¯å¢ƒ ï¼šSTM32F103RBT6&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç”¨æˆ·ç¨‹åºä½ç½®&#34;&gt;ç”¨æˆ·ç¨‹åºä½ç½®
&lt;/h2&gt;&lt;p&gt;ç”¨æˆ·ç¨‹åºåœ¨bspæ–‡ä»¶å¤¹ä¸‹é¢çš„applicationsä¸­çš„applications.cä¸­ä¹¦å†™å’Œè°ƒç”¨ï¼Œå¦‚æœç¨‹åºæ¯”è¾ƒå¤šï¼Œå†æ–°å»ºä¸€ä¸ªcæ–‡ä»¶åˆ†ç¦»å‡ºå»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;spi-é©±åŠ¨æ–‡ä»¶&#34;&gt;SPI é©±åŠ¨æ–‡ä»¶
&lt;/h2&gt;&lt;p&gt;stm32f10xä¸‹é¢çš„driverså¹¶æ²¡æœ‰spié©±åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦å°†stm32f107å¯¹åº”çš„spié©±åŠ¨ç§»æ¤è¿‡æ¥ã€‚å°†rt_stm32f10x_spi.cï¼Œrt_stm32f10x_spi.hï¼Œä»¥åŠplatform.cæ–‡ä»¶å¤åˆ¶è¿‡å»ï¼Œç„¶ååœ¨rt_init_thread_entryå‡½æ•°ä¸­æ·»åŠ rt_platform_init();çš„è°ƒç”¨ï¼Œåœ¨å¯¹åº”æ–‡ä»¶ä¸­åŠ å…¥å¤´æ–‡ä»¶ã€‚ç„¶åä¿®æ”¹SConscriptæ·»åŠ å¯¹platform.cï¼Œrt_stm32f10x_spi.cçš„ç¼–è¯‘ï¼Œå¹¶åœ¨configä¸­æ·»åŠ RT_USING_SPIå’ŒRT_USING_SPI1çš„å®å®šä¹‰&lt;/p&gt;
&lt;p&gt;åœ¨platform.cä¸­spiåˆå§‹åŒ–åŠ å…¥å¦‚ä¸‹ä»£ç ï¼Œé…ç½®é¢‘ç‡&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;        /* config spi */
        {
            struct rt_spi_configuration cfg;
            cfg.data_width = 8;
            cfg.mode = RT_SPI_MODE_3 | RT_SPI_MSB; /* SPI Compatible Modes 3 and SPI_FirstBit_MSB in lis302dl datasheet */
            
            //APB2=168M/2=84M, SPI1 = 84/2,4,8,16,32 = 42M, 21M, 10.5M, 5.25M, 2.625M ...
            cfg.max_hz = 2625000; /* SPI_BaudRatePrescaler_16=84000000/16=5.25MHz. The max_hz of lis302dl is 10MHz in datasheet */ 
            rt_spi_configure(&amp;amp;spi_device, &amp;amp;cfg);
        } /* config spi */  
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ç¡¬ä»¶é…ç½®&#34;&gt;ç¡¬ä»¶é…ç½®
&lt;/h2&gt;&lt;p&gt;ç¡¬ä»¶ç®¡è„šè¢«é…ç½®åœ¨platform.cæ–‡ä»¶ä¸­, æˆ‘ä»¬ä¸ä¿®æ”¹é»˜è®¤çš„é…ç½®,ä¹Ÿå°±æ˜¯ PA4567è¿™å‡ ä¸ªç®¡è„šä¸ºé»˜è®¤çš„spiè¾“å…¥è¾“å‡ºç®¡è„š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;/*
 * SPI1_MOSI: PA7
 * SPI1_MISO: PA6
 * SPI1_SCK : PA5
 *
 * CS0: PA4  SD card. è¿™é‡Œå¯ä»¥æ”¹æˆè‡ªå·±çš„spiè®¾å¤‡çš„csç®¡è„š
*/
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;spiè°ƒç”¨&#34;&gt;SPIè°ƒç”¨
&lt;/h2&gt;&lt;p&gt;SPIè°ƒç”¨ä¸ç”¨ä½¿ç”¨openå‡½æ•°ï¼Œåªéœ€æ‰§è¡Œ&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;    rt_spi_transfer(spi_device, &amp;amp;ReadAddr, &amp;amp;pBuffer, 1);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…rt_spi_send_then_recvä¹Ÿå¯ä»¥å®ç°ä¸åŒçš„æ•ˆæœã€‚&lt;/p&gt;
&lt;h2 id=&#34;uartè°ƒç”¨&#34;&gt;UARTè°ƒç”¨
&lt;/h2&gt;&lt;p&gt;UARTè°ƒç”¨éœ€è¦ä½¿ç”¨openå‡½æ•°ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­ä½¿ç”¨ä¸²å£è®¾å¤‡ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;void device_thread_entry(void* parameter)
{
    rt_device_t device;
    device = rt_device_find(&amp;#34;uart2&amp;#34;);
    rt_device_open(device, RT_DEVICE_OFLAG_RDWR|RT_DEVICE_FLAG_INT_RX);
    char test[10] = &amp;#34;abc&amp;#34;;
    while(1){
        rt_size_t reclen = rt_device_read(device, 0, test, 10);
        if(reclen &amp;gt; 0) rt_device_write(device, 0, test, reclen);
        rt_thread_delay(500);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥å¼€å¯è¿™ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬åœ¨uart2ä¸­è¾“å…¥10ä¸ªä»¥å†…çš„å­—ç¬¦ï¼Œåœ¨5ç§’åå°±ä¼šå›æ˜¾ã€‚å¦‚æœè¶…è¿‡10ä¸ªå­—ç¬¦ï¼Œåº”è¯¥ä¼šåœ¨ä¸‹ä¸€æ¬¡5ç§’æ˜¾ç¤ºã€‚
åœ¨å®˜æ–¹markdownæ–‡æ¡£ä¸­ï¼Œä½¿ç”¨äº†æ¶ˆæ¯æœºåˆ¶æ¥å¤„ç†UARTé€šä¿¡ï¼Œä¹Ÿå¯ä»¥å‚è€ƒã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Ubuntuç¯å¢ƒä¸‹åœ¨STM32ä¸Šéƒ¨ç½²RT-threadç³»ç»Ÿ</title>
        <link>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/ubuntu%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%9C%A8stm32%E4%B8%8A%E9%83%A8%E7%BD%B2rt-thread%E7%B3%BB%E7%BB%9F/</link>
        <pubDate>Thu, 02 Mar 2017 07:59:00 +0000</pubDate>
        
        <guid>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/ubuntu%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%9C%A8stm32%E4%B8%8A%E9%83%A8%E7%BD%B2rt-thread%E7%B3%BB%E7%BB%9F/</guid>
        <description>&lt;p&gt;RT-Threadæ˜¯ä¸€ä¸ªä¸­å›½å¼€æºåµŒå…¥å¼ç³»ç»Ÿï¼Œç›®å‰ç‰ˆæœ¬ä¸º2.2ï¼Œå·²ç»æ”¯æŒè®¸å¤šå¾®æ§åˆ¶å™¨ï¼Œä¾‹å¦‚STM32ç³»åˆ—ï¼Œç”šè‡³å¯ä»¥åœ¨è“ç‰™BLEèŠ¯ç‰‡ä¸­è¿è¡Œã€‚å°½ç®¡å¾®æ§åˆ¶å™¨ä¸­èµ„æºç´§å¼ ï¼Œä½†æ˜¯éƒ¨ç½²ä¸€ä¸ªæ˜“ç”¨çš„å¾®æ“ä½œç³»ç»Ÿå¯¹é¡¹ç›®å¼€å‘å’Œä»£ç ç®¡ç†æ˜¯å¾ˆæœ‰ç›Šçš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‡†å¤‡å·¥å…·&#34;&gt;å‡†å¤‡å·¥å…·
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;STM32å¼€å‘ç‰ˆä¸€ä¸ªï¼Œæ”¯æŒUSBä¸‹è½½åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;Ubuntuç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;USBè½¬ä¸²å£çº¿&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä½¿ç”¨äº†å¤è€çš„&lt;code&gt;ALIENTEK STM32 MINI V2.0&lt;/code&gt; å¼€å‘æ¿ï¼ŒèŠ¯ç‰‡å‹å·ä¸º&lt;code&gt;STM32F103RBT6&lt;/code&gt;ï¼ŒUbuntuç³»ç»Ÿç‰ˆæœ¬ä¸º&lt;code&gt;16.04&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;1ä¸‹è½½äº¤å‰ç¼–è¯‘å·¥å…·é“¾&#34;&gt;1.ä¸‹è½½äº¤å‰ç¼–è¯‘å·¥å…·é“¾
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä¸‹è½½&lt;code&gt;gcc-arm-none-eabi&lt;/code&gt;äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼Œå¯¹äº16.04ç³»ç»Ÿï¼Œç›´æ¥ä½¿ç”¨&lt;code&gt;apt install gcc-arm-none-eabi&lt;/code&gt; è¿›è¡Œå®‰è£…&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2ä¸‹è½½rt-threadç¼–è¯‘å·¥å…·&#34;&gt;2.ä¸‹è½½RT-Threadç¼–è¯‘å·¥å…·
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;è¯¥ç³»ç»Ÿä½¿ç”¨sconsç¼–è¯‘ï¼Œå¯¹äº16.04ç³»ç»Ÿï¼Œä½¿ç”¨ &lt;code&gt;apt install scons&lt;/code&gt; è¿›è¡Œå®‰è£…&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3ä¸‹è½½ç³»ç»Ÿæºç &#34;&gt;3.ä¸‹è½½ç³»ç»Ÿæºç 
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä¸‹è½½RT-Threadç³»ç»Ÿï¼Œåœ°å€ä¸ºï¼š&lt;code&gt;https://github.com/RT-Thread&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è§£å‹ç›®å½•&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;4ä¿®æ”¹ç¼–è¯‘å·¥ç¨‹&#34;&gt;4.ä¿®æ”¹ç¼–è¯‘å·¥ç¨‹
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;è¿›å…¥ç›®å½•&lt;code&gt;bsp/stm32f10x&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç¼–è¾‘æ–‡ä»¶&lt;code&gt;rtconfig.py&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹ CROSS_TOOL ä¸º gcc&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;5é’ˆå¯¹æ¿å­è¿›è¡Œé…ç½®&#34;&gt;5.é’ˆå¯¹æ¿å­è¿›è¡Œé…ç½®
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;stm32f10x.h&lt;/code&gt; ä¸­å¯¹æ™¶æŒ¯è¿›è¡Œé…ç½® &lt;code&gt;HSE_VALUE&lt;/code&gt;ï¼Œä¾‹å¦‚800000&lt;/li&gt;
&lt;li&gt;&lt;code&gt;board.h&lt;/code&gt; ä¸­å¯¹RAMè¿›è¡Œé…ç½® &lt;code&gt;STM32_SRAM_SIZE&lt;/code&gt;ï¼Œä¾‹å¦‚20&lt;/li&gt;
&lt;li&gt;&lt;code&gt;led.c&lt;/code&gt; ä¸­å¯¹ ledè¿›è¡Œé…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;6ç¼–è¯‘æºç &#34;&gt;6.ç¼–è¯‘æºç 
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;åœ¨&lt;code&gt;bsp/stm32f10x&lt;/code&gt;ç›®å½•ä¸‹è¿è¡Œ &lt;code&gt;scons&lt;/code&gt;ï¼Œè¾“å…¥rtthread.binæ–‡ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;7çƒ§å½•ä»£ç &#34;&gt;7.çƒ§å½•ä»£ç 
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä½ å¯ä»¥ä½¿ç”¨Jlinkè¿›è¡Œä¸‹è½½ï¼Œé¡»åœ¨Jlinkå®˜ç½‘ä¸‹è½½Linuxæ‰§è¡Œæ–‡ä»¶ï¼Œç”±äºæˆ‘æ˜¯debianç³»ç»Ÿï¼Œå¯ä»¥ç›´æ¥æ‰“å¼€JLink_Linux_V614a_x86_64.debæ–‡ä»¶è¿›è¡Œå®‰è£…ã€‚ç„¶ååœ¨ç³»ç»Ÿæ–‡ä»¶ä¸‹lib/ç›®å½•ä¸‹æ‰§è¡Œ&lt;code&gt;JlinkExe&lt;/code&gt;æ–‡ä»¶ï¼Œå³å¯ä»¥é€šè¿‡Jlinkè¿›è¡Œä¸‹è½½çƒ§å½•ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;è¿™é‡Œæˆ‘é‡‡ç”¨äº†æ›´ä¸ºæ–¹ä¾¿çš„ä¸²å£çƒ§å½•ã€‚é¦–å…ˆå°†å¼€å‘æ¿çš„B0æ¥é«˜ç”µå¹³ï¼ŒB1æ¥ä½ç”µå¹³ï¼Œç„¶åä½¿ç”¨STM32flash-5.0è¿™ä¸ªè½¯ä»¶è¿›è¡Œçƒ§å½•ã€‚
&lt;ul&gt;
&lt;li&gt;ä¸‹è½½åœ°å€&lt;code&gt;https://sourceforge.net/projects/stm32flash/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è§£å‹ç›®å½•ï¼Œåœ¨è¯¥ç›®å½•ä¸‹è¿è¡Œmakeï¼Œå¾—åˆ°stm32flash&lt;/li&gt;
&lt;li&gt;å°†&lt;code&gt;rtthread.bin&lt;/code&gt;å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸‹ï¼Œæ¥å…¥USBè½¬ä¸²å£çº¿ï¼Œç„¶åè¾“å…¥&lt;code&gt;sudo ./stm32flash -w rtthread.bin -v -g 0x0 /dev/ttyUSB0&lt;/code&gt;ï¼Œå…¶ä¸­&lt;code&gt;ttyUSB0&lt;/code&gt;æ˜¯ä¸²å£è®¾å¤‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;8æ£€æŸ¥æ˜¯å¦æˆåŠŸ&#34;&gt;8.æ£€æŸ¥æ˜¯å¦æˆåŠŸ
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;è‹¥èƒ½çœ‹åˆ°LEDç¯é—ªçƒï¼Œåˆ™æˆåŠŸ&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Cubieboard2 æ·»åŠ SPI é©±åŠ¨æ”¯æŒ</title>
        <link>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/cubieboard2-%E6%B7%BB%E5%8A%A0spi-%E9%A9%B1%E5%8A%A8%E6%94%AF%E6%8C%81/</link>
        <pubDate>Tue, 28 Feb 2017 12:14:00 +0000</pubDate>
        
        <guid>https://nansenli.com/zh-cn/post/jianshu/%E5%B5%8C%E5%85%A5%E5%BC%8F/cubieboard2-%E6%B7%BB%E5%8A%A0spi-%E9%A9%B1%E5%8A%A8%E6%94%AF%E6%8C%81/</guid>
        <description>&lt;p&gt;##0.å‰è¨€&lt;/p&gt;
&lt;p&gt;ç”±äºcubieboard2å®˜æ–¹ç¨³å®šç‰ˆå†…æ ¸linux-3.4æœªæ·»åŠ åŸç”Ÿspié©±åŠ¨æ”¯æŒï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä¿®æ”¹å†…æ ¸æºç ï¼Œç¼–è¯‘å¹¶æ”¾å…¥nandä¸­ï¼Œæ›¿æ¢æ‰åŸæ¥çš„uImageé•œåƒï¼Œå¹¶æ”¾å…¥æ–°å†…æ ¸çš„æ¨¡å—æ–‡ä»¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶ï¼Œä½¿å…¶å®Œæ•´æ”¯æŒå…¨åŒå·¥é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;##1.åˆ·å…¥debianç³»ç»Ÿåˆ°nandã€‚ï¼ˆwindowsä¸‹ï¼‰&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä¸‹è½½ä¸ºcubieboard2å®šåˆ¶çš„debianç³»ç»Ÿï¼Œåœ°å€ä¸ºï¼šhttp://dl.cubieboard.org/software/a20-cubieboard/debian/nand/debian-nand.img.gz&lt;/p&gt;
&lt;p&gt;ä¸‹è½½Phoenixsuitï¼Œé€šè¿‡Phoenixsuitæ‰“å¼€ä¸‹è½½çš„é•œåƒã€‚åœ¨cubieboard2æœªæ¥ç”µæºçš„çŠ¶æ€ä¸‹æŒ‰ä½FELæŒ‰é’®çš„åŒæ—¶é€šè¿‡OTGçº¿æ¥å…¥ç”µè„‘ï¼Œåœ¨è®¾å¤‡ç®¡ç†å™¨å°†è¿™ä¸ªæœªè¯†åˆ«çš„è®¾å¤‡å®‰è£…é©±åŠ¨ï¼ŒæŒ‡å®šé©±åŠ¨å®‰è£…ç›®å½•ä¸ºPhoenixsuitçš„å®‰è£…ç›®å½•ï¼Œç¡®è®¤å®‰è£…ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ ¼å¼åŒ–å¹¶åˆ·å…¥é•œåƒã€‚&lt;/p&gt;
&lt;p&gt;##2.ç™»é™†ç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;å°†cubieboard2æ¥å…¥ç½‘çº¿ï¼Œè¯¥debianç³»ç»Ÿé»˜è®¤è®¾ä¸ºé™æ€ipåœ°å€192.168.1.124ï¼Œä½ å¯ä»¥é€šè¿‡sshè¿›å…¥è¯¥ç³»ç»Ÿã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡TTLçº¿ä»UARTè¿›è¡Œç™»é™†ï¼Œä¿®æ”¹ä¸ºDHCPæ–¹å¼ï¼Œç„¶åä»è·¯ç”±å™¨æŸ¥çœ‹IPåœ°å€ï¼Œå†ç™»é™†ã€‚è·¯ç”±å™¨è´¦æˆ·åå¯†ç ä¸ºroot/cubieboardã€‚&lt;/p&gt;
&lt;p&gt;##3.ä¿®æ”¹å†…æ ¸ï¼ˆubuntuä¸‹ï¼‰&lt;/p&gt;
&lt;p&gt;ç›®å‰linuxå†…æ ¸ä¸æ”¯æŒcubieboard2çš„spié©±åŠ¨ã€‚é¦–å…ˆä¸‹è½½å†…æ ¸æºç linux-3.4åˆ†æ”¯ï¼šhttps://github.com/linux-sunxi/linux-sunxi ã€‚ç„¶åä¸ºå†…æ ¸å¢åŠ spiæ”¯æŒï¼ˆä¸å»ºè®®ï¼‰ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹ &lt;a class=&#34;link&#34; href=&#34;http://blog.csdn.net/u010352603/article/details/51657265#&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://blog.csdn.net/u010352603/article/details/51657265#&lt;/a&gt; ã€‚è¿™é‡Œç›´æ¥ä¸‹è½½å·²ç»ä¿®æ”¹å¥½çš„spiæ”¯æŒï¼Œåœ°å€ &lt;a class=&#34;link&#34; href=&#34;https://github.com/linanwx/cubieboard2-spi-support&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/linanwx/cubieboard2-spi-support&lt;/a&gt; ã€‚ä¸‹è½½åï¼Œå°†å†…æ ¸ç›®å½•drivers/spiåˆ é™¤ï¼Œå°†ä¸‹è½½çš„spiæ–‡ä»¶å¤¹æ”¾åœ¨åˆ é™¤çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;##4.ç¼–è¯‘å†…æ ¸ï¼ˆubuntuä¸‹ï¼‰&lt;/p&gt;
&lt;p&gt;å‡†å¤‡å¥½arm-linux-gnueabihf-gccç¼–è¯‘å™¨ï¼Œç‰ˆæœ¬ä¸é«˜äº5.0&lt;/p&gt;
&lt;p&gt;åœ¨å†…æ ¸ç›®å½•ä¸­ï¼Œä½¿ç”¨ç»ˆç«¯ï¼Œè¾“å…¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;make ARCH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;arm CROSS_COMPILE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;arm-linux-gnueabihf- sun7i_defconfig
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å…¥&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;gedit .config
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰¾åˆ°ä»¥ä¸‹é€‰é¡¹ï¼Œå¹¶å°†å…¶æ”¹ä¸º&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;CONFIG_SPI=y
CONFIG_SUNXI_NAND_PARTITION=y
CONFIG_SUNXI_NAND=y
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¼€å§‹ç¼–è¯‘å†…æ ¸&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;make -j4ARCH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;arm CROSS_COMPILE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;arm-linux-gnueabihf- uImage modules
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºå¼€å¯äº†CONFIG_SPIæ”¯æŒå’ŒCONFIG_SUNXI_NANDæ”¯æŒï¼Œéœ€è¦è¿›è¡Œä¸€ç³»åˆ—çš„è®¾ç½®ã€‚å½“é‡åˆ°spi supportï¼ŒCONFIG_SPI_SUN7Iï¼ŒCONFIG_SUN7I_SPI_NDMAæ—¶ï¼Œè¾“å…¥yï¼Œå…¶ä»–æƒ…å†µè¾“å…¥å›è½¦ã€‚&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥è·¯å¾„arch/arm/bootä¸‹æ˜¯å¦æœ‰uImageæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;è¾“å…¥ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå†…æ ¸æ¨¡å—&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;make ARCH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;arm CROSS_COMPILE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;arm-linux-gnueabihf- INSTALL_MOD_PATH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;output modules_install
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ£€æŸ¥è·¯å¾„&lt;code&gt;output/lib/modules/3.4.104&lt;/code&gt;ç›®å½•æ˜¯å¦äº§ç”Ÿ&lt;/p&gt;
&lt;p&gt;##5.æ›¿æ¢å†…æ ¸ï¼ˆcubieboard2ä¸‹ï¼‰&lt;/p&gt;
&lt;p&gt;åœ¨cubieboard2 ä¸­ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mkdir /media/nanda
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mount /dev/nanda /media/nanda
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†uImageæ‹·è´è‡³cubieboard2 debianç³»ç»Ÿçš„&lt;code&gt;/media/nanda&lt;/code&gt;ç›®å½•è¦†ç›–åŸæ¥å†…æ ¸&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨tarå‘½ä»¤æ‰“åŒ…&lt;code&gt;output/lib/modules/3.4.104&lt;/code&gt; ç›®å½•ï¼Œå°†è¯¥æ–‡ä»¶ä¼ å…¥cubieboard2 çš„ &lt;code&gt;/lib/modules&lt;/code&gt; ç›®å½•ï¼Œç„¶åè§£å‹&lt;/p&gt;
&lt;p&gt;##6.æ£€æŸ¥ç¼–è¯‘æˆåŠŸ&lt;/p&gt;
&lt;p&gt;é‡å¯ï¼Œå¦‚æœç³»ç»Ÿæ­£å¸¸è¿›å…¥ï¼Œåˆ™æˆåŠŸ&lt;/p&gt;
&lt;p&gt;##7.ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶æ‰“å¼€SPIï¼Œå¹¶ä½¿å…¶æ”¯æŒå…¨åŒå·¥SPIï¼ˆcubieboard2ä¸‹ï¼‰
é‡æ–°æŒ‚è½½&lt;code&gt;/dev/nanda&lt;/code&gt;åˆ°&lt;code&gt;/media/nanda/&lt;/code&gt; ç›®å½•å¹¶è¿›å…¥&lt;/p&gt;
&lt;p&gt;è¾“å…¥å¦‚ä¸‹å‘½ä»¤&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bin2fex script.bin script.fex
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nano script.fex
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰¾åˆ°[spi0_para]ï¼Œå°†å…¶ä¸‹é¢çš„usedæ”¹ä¸º1ï¼Œå¹¶é¢å¤–å¢åŠ å¦‚ä¸‹ä»£ç &lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[spi_devices]
spi_dev_num =1

[spi_board0]
modalias =&amp;#34;spidev&amp;#34;
max_speed_hz =100000
bus_num =0
chip_select =0
mode =0
full_duplex =1
manual_cs =0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¾“å…¥å¦‚ä¸‹å‘½ä»¤&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fex2bin script.fex script.bin
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nano /usr/include/linux/spi/spidev.h
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨&lt;code&gt;__u16 delay_usecs;&lt;/code&gt;ä¸Šé¢ä¸€è¡Œæ·»åŠ &lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;__u16 interbyte_usecs;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;##8.æµ‹è¯•spi
é‡å¯cubieboard2ã€‚æ£€æŸ¥è·¯å¾„&lt;code&gt;/dev&lt;/code&gt;ä¸‹æ˜¯å¦å­˜åœ¨spidevè®¾å¤‡ã€‚çŸ­æ¥46ï¼Œ48pinè„šï¼Œç®¡è„šå›¾&lt;code&gt;http://docs.cubieboard.org/products/a10_cubieboard/expansion_ports&lt;/code&gt;ã€‚
æ–°å»ºæ–‡æœ¬è¾“å…¥å¦‚ä¸‹ä»£ç &lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;/* 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * SPI testing utility (using spidev driver) 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * Copyright (c) 2007  MontaVista Software, Inc. 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * Copyright (c) 2007  Anton Vorontsov &amp;lt;avorontsov@ru.mvista.com&amp;gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * This program is free software; you can redistribute it and/or modify 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * it under the terms of the GNU General Public License as published by 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * the Free Software Foundation; either version 2 of the License. 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; * Cross-compile with cross-gcc -I/path/to/cross-kernel/include 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt; */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;stdint.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;getopt.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;fcntl.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;sys/ioctl.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;linux/types.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;linux/spi/spidev.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#define ARRAY_SIZE(a) (sizeof(a) / sizeof((a)[0]))
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;s)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;perror&lt;/span&gt;(s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;abort&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;device &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/dev/spidev0.0&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8_t&lt;/span&gt; mode;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8_t&lt;/span&gt; bits &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;uint32_t&lt;/span&gt; speed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;500000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;uint16_t&lt;/span&gt; delay;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;transfer&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; fd)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; ret;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8_t&lt;/span&gt; tx[] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0x40&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x95&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xFF&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xDE&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xAD&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xBE&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xEF&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xBA&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0xAD&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xF0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x0D&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8_t&lt;/span&gt; rx[&lt;span style=&#34;color:#a6e22e&#34;&gt;ARRAY_SIZE&lt;/span&gt;(tx)] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; spi_ioc_transfer tr &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .tx_buf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;long&lt;/span&gt;)tx,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .rx_buf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;long&lt;/span&gt;)rx,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .len &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ARRAY_SIZE&lt;/span&gt;(tx),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .delay_usecs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; delay,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .speed_hz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; speed,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .bits_per_word &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bits,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, &lt;span style=&#34;color:#a6e22e&#34;&gt;SPI_IOC_MESSAGE&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;tr);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t send spi message&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; ret &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ARRAY_SIZE&lt;/span&gt;(tx); ret&lt;span style=&#34;color:#f92672&#34;&gt;++&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(ret &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;puts&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;%.2X &amp;#34;&lt;/span&gt;, rx[ret]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;puts&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;print_usage&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;prog)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Usage: %s [-DsbdlHOLC3]&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, prog);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;puts&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -D --device   device to use (default /dev/spidev0.0)&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -s --speed    max speed (Hz)&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -d --delay    delay (usec)&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -b --bpw      bits per word &lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -l --loop     loopback&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -H --cpha     clock phase&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -O --cpol     clock polarity&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -L --lsb      least significant bit first&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -C --cs-high  chip select active high&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;  -3 --3wire    SI/SO signals shared&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;exit&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;parse_opts&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; option lopts[] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;device&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;D&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;speed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;s&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;delay&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;bpw&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;loop&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;l&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cpha&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;H&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cpol&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;O&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;lsb&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;L&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cs-high&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;3wire&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;no-cs&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;N&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ready&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {NULL, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        c &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getopt_long&lt;/span&gt;(argc, argv, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:s:d:b:lHOLC3NR&amp;#34;&lt;/span&gt;, lopts, NULL);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (c &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;switch&lt;/span&gt; (c)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;D&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            device &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; optarg;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;s&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            speed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;atoi&lt;/span&gt;(optarg);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            delay &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;atoi&lt;/span&gt;(optarg);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            bits &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;atoi&lt;/span&gt;(optarg);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;l&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_LOOP;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_CPHA;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;O&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_CPOL;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;L&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_LSB_FIRST;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;C&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_CS_HIGH;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_3WIRE;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;N&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_NO_CS;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            mode &lt;span style=&#34;color:#f92672&#34;&gt;|=&lt;/span&gt; SPI_READY;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;default&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;print_usage&lt;/span&gt;(argv[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; fd;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;parse_opts&lt;/span&gt;(argc, argv);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;open&lt;/span&gt;(device, O_RDWR);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (fd &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t open device&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;/* 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;         * spi mode 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;         */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, SPI_IOC_WR_MODE, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;mode);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t set spi mode&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, SPI_IOC_RD_MODE, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;mode);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t get spi mode&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;/* 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;         * bits per word 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;         */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, SPI_IOC_WR_BITS_PER_WORD, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;bits);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t set bits per word&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, SPI_IOC_RD_BITS_PER_WORD, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;bits);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t get bits per word&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;/* 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;         * max speed hz 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;         */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, SPI_IOC_WR_MAX_SPEED_HZ, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;speed);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t set max speed hz&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ioctl&lt;/span&gt;(fd, SPI_IOC_RD_MAX_SPEED_HZ, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;speed);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ret &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;pabort&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;can&amp;#39;t get max speed hz&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;spi mode: %d&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, mode);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;bits per word: %d&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, bits);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;max speed: %d Hz (%d KHz)&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, speed, speed &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1000&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;transfer&lt;/span&gt;(fd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;(fd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ret;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¯¥æ–‡ä»¶è¿è¡Œï¼Œè‹¥è¾“å‡ºç»“æœå¦‚ä¸‹åˆ™ä¿®æ”¹æˆåŠŸ&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;spi mode: 0
bits per word: 8
max speed: 500000 Hz (500 KHz)

FF FF FF FF FF FF 
40 00 00 00 00 95 
FF FF FF FF FF FF 
FF FF FF FF FF FF 
FF FF FF FF FF FF 
DE AD BE EF BA AD 
F0 0D 
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>ARM GIC-400 å¯„å­˜å™¨</title>
        <link>https://nansenli.com/zh-cn/post/kokeyuan/arm-gic-400-registers/</link>
        <pubDate>Thu, 30 Jun 2016 20:00:00 +0000</pubDate>
        
        <guid>https://nansenli.com/zh-cn/post/kokeyuan/arm-gic-400-registers/</guid>
        <description>&lt;h2 id=&#34;1ç®€ä»‹&#34;&gt;1.ç®€ä»‹
&lt;/h2&gt;&lt;p&gt;GIC-400æ˜¯ç”¨äºæ§åˆ¶ä¸­æ–­çš„ã€‚åœ¨cubieboard2 ä¸Š çš„A20èŠ¯ç‰‡é‡‡ç”¨äº†è¿™æ¬¾æ§åˆ¶å™¨ã€‚&lt;/p&gt;
&lt;p&gt;cubieboard2 çš„GICæ§åˆ¶å™¨ çš„åœ°å€æ˜¯0x01C80000&amp;mdash;0x01C87FFF ï¼Œé•¿åº¦ç­‰äºGIC-400å¯„å­˜å™¨çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ä»¥0x01C80000ä¸ºèµ·å§‹åœ°å€ï¼Œä¸‹é¢ç»™å‡ºçš„æ˜¯åç§»ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åç§»åœ°å€&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0x0000-0x0FFF&lt;/td&gt;
&lt;td&gt;Reserved æœªä½¿ç”¨ï¼Œæ— ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x1000-0x1FFF&lt;/td&gt;
&lt;td&gt;Distributor é…ç½®å™¨ æœ‰ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x2000-0x3FFF&lt;/td&gt;
&lt;td&gt;CPU interfaces CPUæ¥å£ æœ‰ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x4000-0x4FFF&lt;/td&gt;
&lt;td&gt;Virtual interface control block, for the processor that is performing the access&lt;!-- raw HTML omitted --&gt;è™šæ‹ŸåŒ–ç›¸å…³ï¼Œæ— ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x5000-0x5FFF&lt;/td&gt;
&lt;td&gt;Virtual interface control block, for the processor selected by address bits [11:9]&lt;!-- raw HTML omitted --&gt;è™šæ‹ŸåŒ–ç›¸å…³ï¼Œæ— ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x5000-0x51FF&lt;!-- raw HTML omitted --&gt;0x5200-0x53FF&lt;!-- raw HTML omitted --&gt;&amp;hellip;&lt;!-- raw HTML omitted --&gt;0x5E00-0x5FFF&lt;/td&gt;
&lt;td&gt;Alias for Processor 0&lt;!-- raw HTML omitted --&gt;Alias for Processor 1&lt;!-- raw HTML omitted --&gt;&amp;hellip;&lt;!-- raw HTML omitted --&gt;Alias for Processor 7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x6000-0x7FFF&lt;/td&gt;
&lt;td&gt;Virtual CPU interfaces&lt;!-- raw HTML omitted --&gt;è™šæ‹ŸåŒ–ç›¸å…³ï¼Œæ— ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¸¸ç”¨çš„æ˜¯å›¾ä¸­ç¬¬äºŒå—å’Œç¬¬ä¸‰å—ï¼Œ0x1000~0x3fffè¿™éƒ¨åˆ†çš„é…ç½®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2distributor-é…ç½®å™¨&#34;&gt;2.Distributor é…ç½®å™¨
&lt;/h2&gt;&lt;p&gt;distributorè¿™å—å¯„å­˜å™¨çš„åœ°å€ = GICæ§åˆ¶å™¨ çš„åœ°å€ + 0x1000 ï¼Œä½¿ç”¨çš„æ—¶å€™åˆ«å¿˜è®°äº†åç§»ã€‚ç„¶åä»è¿™é‡Œå¼€å§‹ï¼Œæœ‰å¦‚ä¸‹çš„å¯„å­˜å™¨&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åç§»&lt;/th&gt;
&lt;th&gt;åç§°&lt;/th&gt;
&lt;th&gt;å¯è¯»å†™&lt;/th&gt;
&lt;th&gt;å¤ä½å&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0x000&lt;/td&gt;
&lt;td&gt;GICD_CTLR&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000[c]&lt;/td&gt;
&lt;td&gt;Distributor Control Register&lt;!-- raw HTML omitted --&gt;å†™å…¥1ä½¿èƒ½æ§åˆ¶å™¨ï¼Œå¿…å¤‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x004&lt;/td&gt;
&lt;td&gt;GICD_TYPER&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;Configuration-dependent[d]&lt;/td&gt;
&lt;td&gt;Interrupt Controller Type Register&lt;!-- raw HTML omitted --&gt;å…¶ä¸­å¯ä»¥æŸ¥çœ‹ä¸­æ–­çº¿çš„æ€»æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x008&lt;/td&gt;
&lt;td&gt;GICD_IIDR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x0200143B&lt;/td&gt;
&lt;td&gt;Distributor Implementer Identification Register, GICD_IIDR&lt;!-- raw HTML omitted --&gt;å­˜äº†ä¸€äº›ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ²¡ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x080-0x0BC&lt;/td&gt;
&lt;td&gt;GICD_IGROUPRn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Group Registers[e]&lt;!-- raw HTML omitted --&gt;ä¸€ä¸ªä½å›¾ï¼Œæ§åˆ¶ä¸­æ–­å±äºAç»„è¿˜æ˜¯Bç»„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x100&lt;/td&gt;
&lt;td&gt;GICD_ISENABLERn&lt;/td&gt;
&lt;td&gt;RW[f]&lt;/td&gt;
&lt;td&gt;SGIs and PPIs:0x0000FFFF[g]&lt;/td&gt;
&lt;td&gt;Interrupt Set-Enable Registers&lt;!-- raw HTML omitted --&gt;ä¸€ä¸ªä½å›¾ï¼Œç”¨äºä½¿èƒ½å„ä¸ªä¸­æ–­ï¼Œå†™å…¥1ä½¿èƒ½ã€‚æœ‰ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x104-0x13C&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;SPIs: 0x00000000&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x180&lt;/td&gt;
&lt;td&gt;GICD_ICENABLERn&lt;/td&gt;
&lt;td&gt;RW[f]&lt;/td&gt;
&lt;td&gt;0x0000FFFF[g]&lt;/td&gt;
&lt;td&gt;Interrupt Clear-Enable Registers&lt;!-- raw HTML omitted --&gt;å’Œä¸Šä¸€ä¸ªå¯„å­˜å™¨ç±»ä¼¼ï¼Œä½œç”¨ç›¸åï¼Œå†™å…¥1ç¦æ­¢ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x184-0x1BC&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x200-0x23C&lt;/td&gt;
&lt;td&gt;GICD_ISPENDRn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Set-Pending Registers&lt;!-- raw HTML omitted --&gt;pendä½å›¾ï¼Œå†™å…¥1å¯ä»¥è¿›å…¥pendçŠ¶æ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x280-0x2BC&lt;/td&gt;
&lt;td&gt;GICD_ICPENDRn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Clear-Pending Registers&lt;!-- raw HTML omitted --&gt;åŒä¸Šï¼Œå†™å…¥1æ•ˆæœç›¸åï¼Œé˜»æ­¢pendçŠ¶æ€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x300-0x33C&lt;/td&gt;
&lt;td&gt;GICD_ISACTIVERn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Set-Active Registers&lt;!-- raw HTML omitted --&gt;ä½å›¾ï¼Œå†™å…¥1å¯ä»¥æ¿€æ´»ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x380-0x3BC&lt;/td&gt;
&lt;td&gt;GICD_ICACTIVERn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Clear-Active Registers&lt;!-- raw HTML omitted --&gt;å†™å…¥1åæ¿€æ´»ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x400-0x5FC&lt;/td&gt;
&lt;td&gt;GICD_IPRIORITYRn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Priority Registers&lt;!-- raw HTML omitted --&gt;å­˜ç€å„ä¸ªä¸­æ–­çš„ä¼˜å…ˆçº§ï¼Œæ¯8ä½ç®—ä¸€ä¸ª&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x800-0x81C&lt;/td&gt;
&lt;td&gt;GICD_ITARGETSRn&lt;/td&gt;
&lt;td&gt;RO[h]&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;Interrupt Processor Targets Registers[i]&lt;!-- raw HTML omitted --&gt;æŸä¸ªä¸­æ–­åº”è¯¥å‘å¾€å“ªä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x820-0x9FC&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xC00&lt;/td&gt;
&lt;td&gt;GICD_ICFGRn&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;SGIs: 0xAAAAAAAA&lt;/td&gt;
&lt;td&gt;Interrupt Configuration Registers, GICD_ICFGRn&lt;!-- raw HTML omitted --&gt;é…ç½®ä¸­æ–­æ˜¯ä½ç”µå¹³è§¦å‘è¿˜æ˜¯ä¸‹é™æ²¿è§¦å‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xC04&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;PPIs: 0x55540000&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xC08-0xC7C&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RW[j]&lt;/td&gt;
&lt;td&gt;SPIs: 0x55555555&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xD00&lt;/td&gt;
&lt;td&gt;GICD_PPISR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Private Peripheral Interrupt Status Register, GICD_PPISR&lt;!-- raw HTML omitted --&gt;ä¸€èˆ¬æ²¡ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xD04-0xD3C&lt;/td&gt;
&lt;td&gt;GICD_SPISRn&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Shared Peripheral Interrupt Status Registers, GICD_SPISRn&lt;!-- raw HTML omitted --&gt;æ²¡ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xF00&lt;/td&gt;
&lt;td&gt;GICD_SGIR&lt;/td&gt;
&lt;td&gt;WO&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;Software Generated Interrupt Register&lt;!-- raw HTML omitted --&gt;æ§åˆ¶è½¯ä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xF10-0xF1C&lt;/td&gt;
&lt;td&gt;GICD_CPENDSGIRn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;SGI Clear-Pending Registers&lt;!-- raw HTML omitted --&gt;è½¯ä¸­æ–­çš„pendä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xF20-0xF2C&lt;/td&gt;
&lt;td&gt;GICD_SPENDSGIRn&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;SGI Set-Pending Registers&lt;!-- raw HTML omitted --&gt;åŒä¸Šï¼Œä¸è¿‡å†™å…¥1æ—¶åœæ­¢pend&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFD0&lt;/td&gt;
&lt;td&gt;GICD_PIDR4&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000004&lt;/td&gt;
&lt;td&gt;Peripheral ID 4 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFD4&lt;/td&gt;
&lt;td&gt;GICD_PIDR5&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Peripheral ID 5 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFD8&lt;/td&gt;
&lt;td&gt;GICD_PIDR6&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Peripheral ID 6 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFDC&lt;/td&gt;
&lt;td&gt;GICD_PIDR7&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Peripheral ID 7 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFE0&lt;/td&gt;
&lt;td&gt;GICD_PIDR0&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000090&lt;/td&gt;
&lt;td&gt;Peripheral ID 0 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFE4&lt;/td&gt;
&lt;td&gt;GICD_PIDR1&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000000B4&lt;/td&gt;
&lt;td&gt;Peripheral ID 1 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFE8&lt;/td&gt;
&lt;td&gt;GICD_PIDR2&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x0000002B&lt;/td&gt;
&lt;td&gt;Peripheral ID 2 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFEC&lt;/td&gt;
&lt;td&gt;GICD_PIDR3&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Peripheral ID 3 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFF0&lt;/td&gt;
&lt;td&gt;GICD_CIDR0&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x0000000D&lt;/td&gt;
&lt;td&gt;Component ID 0 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFF4&lt;/td&gt;
&lt;td&gt;GICD_CIDR1&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000000F0&lt;/td&gt;
&lt;td&gt;Component ID 1 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFF8&lt;/td&gt;
&lt;td&gt;GICD_CIDR2&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x00000005&lt;/td&gt;
&lt;td&gt;Component ID 2 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0xFFC&lt;/td&gt;
&lt;td&gt;GICD_CIDR3&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000000B1&lt;/td&gt;
&lt;td&gt;Component ID 3 Register&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;3cpuæ¥å£&#34;&gt;3.CPUæ¥å£
&lt;/h2&gt;&lt;p&gt;å¼€å§‹åœ°å€çš„åç§»é‡ä¸º0x2000&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Offset&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Reset&lt;/th&gt;
&lt;th&gt;Description[a]&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0x0000&lt;/td&gt;
&lt;td&gt;GICC_CTLR&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;CPU Interface Control Register&lt;!-- raw HTML omitted --&gt;ä½¿èƒ½ä½ã€‚å†™å…¥1ä½¿èƒ½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0004&lt;/td&gt;
&lt;td&gt;GICC_PMR&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Interrupt Priority Mask Register&lt;!-- raw HTML omitted --&gt;é™åˆ¶ä¸­æ–­æœ€ä½ä¼˜å…ˆçº§ï¼Œé«˜äºæ­¤å€¼æ— æ³•ä¸­æ–­ï¼Œæœ€å¥½å†™å¤§ä¸€ç‚¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0008&lt;/td&gt;
&lt;td&gt;GICC_BPR&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000002[b]&lt;/td&gt;
&lt;td&gt;Binary Point Register&lt;!-- raw HTML omitted --&gt;The minimum value of the Binary Point Register depends on which security-banked copy is considered:&lt;!-- raw HTML omitted --&gt;0x2 Secure copy&lt;!-- raw HTML omitted --&gt;0x3 Non-secure copy&lt;!-- raw HTML omitted --&gt;ä¼˜å…ˆçº§åˆ†ç»„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x000C&lt;/td&gt;
&lt;td&gt;GICC_IAR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000003FF&lt;/td&gt;
&lt;td&gt;Interrupt Acknowledge Register&lt;!-- raw HTML omitted --&gt;åªè¯»ï¼Œä¸­æ–­id&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0010&lt;/td&gt;
&lt;td&gt;GICC_EOIR&lt;/td&gt;
&lt;td&gt;WO&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;End of Interrupt Register&lt;!-- raw HTML omitted --&gt;å†™å…¥ä»¥å‘ŠçŸ¥cpuå·²ç»å¤„ç†å®Œä¸­æ–­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0014&lt;/td&gt;
&lt;td&gt;GICC_RPR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000000FF&lt;/td&gt;
&lt;td&gt;Running Priority Register&lt;!-- raw HTML omitted --&gt;å½“å‰ä¸­æ–­ä¼˜å…ˆçº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0018&lt;/td&gt;
&lt;td&gt;GICC_HPPIR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000003FF&lt;/td&gt;
&lt;td&gt;Highest Priority Pending Interrupt Register [c]&lt;!-- raw HTML omitted --&gt;æœ€é«˜ä¼˜å…ˆçº§ä¸­æ–­å·åŠå…¶pendå€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x001C&lt;/td&gt;
&lt;td&gt;GICC_ABPR&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000003&lt;/td&gt;
&lt;td&gt;Aliased Binary Point Register[d]&lt;!-- raw HTML omitted --&gt;The minimum value of the Aliased Binary Point Register is 0x3.&lt;!-- raw HTML omitted --&gt;åˆ«åå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0020&lt;/td&gt;
&lt;td&gt;GICC_AIAR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000003FF&lt;/td&gt;
&lt;td&gt;Aliased Interrupt Acknowledge Register[d]&lt;!-- raw HTML omitted --&gt;åˆ«åå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0024&lt;/td&gt;
&lt;td&gt;GICC_AEOIR&lt;/td&gt;
&lt;td&gt;WO&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;Aliased End of Interrupt Register[d]&lt;!-- raw HTML omitted --&gt;åˆ«åå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x0028&lt;/td&gt;
&lt;td&gt;GICC_AHPPIR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x000003FF&lt;/td&gt;
&lt;td&gt;Aliased Highest Priority Pending Interrupt Register[c][d]&lt;!-- raw HTML omitted --&gt;åˆ«åå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x00D0&lt;/td&gt;
&lt;td&gt;GICC_APR0&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Active Priority Register&lt;!-- raw HTML omitted --&gt;ç”¨äºä¿å­˜å’Œæ¢å¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x00E0&lt;/td&gt;
&lt;td&gt;GICC_NSAPR0&lt;/td&gt;
&lt;td&gt;RW&lt;/td&gt;
&lt;td&gt;0x00000000&lt;/td&gt;
&lt;td&gt;Non-Secure Active Priority Register[d]&lt;!-- raw HTML omitted --&gt;ç”¨äºä¿å­˜å’Œæ¢å¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x00FC&lt;/td&gt;
&lt;td&gt;GICC_IIDR&lt;/td&gt;
&lt;td&gt;RO&lt;/td&gt;
&lt;td&gt;0x0202143B&lt;/td&gt;
&lt;td&gt;CPU Interface Identification Register, GICC_IIDR&lt;!-- raw HTML omitted --&gt;å­˜ç€ç‰ˆæœ¬ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0x1000&lt;/td&gt;
&lt;td&gt;GICC_DIR&lt;/td&gt;
&lt;td&gt;WO&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;Deactivate Interrupt Register&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
        </item>
        
    </channel>
</rss>
